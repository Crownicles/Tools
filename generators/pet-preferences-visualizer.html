<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pr√©f√©rences d'Exp√©dition des Familiers</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --bg-tertiary: #f1f5f9;
            --accent: #b91c1c;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --success: #22c55e;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;

            /* Terrain Colors */
            --color-plains: #dcfce7;
            --color-forest: #dcfce7;
            --color-coast: #dbeafe;
            --color-mountain: #ffffff;
            --color-desert: #fef3c7;
            --color-swamp: #ecfccb;
            --color-ruins: #f1f5f9;
            --color-cave: #f3f4f6;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 20px;
            margin: 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            color: var(--text-primary);
            font-weight: 800;
        }

        .card {
            background: var(--bg-secondary);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            border: 1px solid #e2e8f0;
        }

        .controls {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        input, select {
            background: white;
            border: 1px solid #cbd5e1;
            color: var(--text-primary);
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 1rem;
            flex-grow: 1;
        }

        .pet-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .pet-card {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #e2e8f0;
            transition: all 0.2s;
        }

        .pet-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .pet-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .pet-id {
            background: #f1f5f9;
            color: #64748b;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .pet-name {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--text-primary);
        }

        .preference-section {
            margin-top: 15px;
            padding: 12px;
            border-radius: 8px;
            background: #fdfdfd;
            border: 1px solid #e2e8f0;
        }

        .preference-section.liked {
            border: 2px solid var(--success);
            background: #f0fdf4;
        }

        .preference-section.disliked {
            border: 2px solid var(--danger);
            background: #fef2f2;
        }

        .preference-title {
            font-size: 0.75rem;
            text-transform: uppercase;
            color: var(--text-secondary);
            margin-bottom: 10px;
            font-weight: 800;
            letter-spacing: 0.05em;
        }

        .tag-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .tag {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 600;
            border: 1px solid rgba(0,0,0,0.05);
        }

        .tag.plains { background-color: var(--color-plains); }
        .tag.forest { background-color: var(--color-forest); }
        .tag.coast { background-color: var(--color-coast); }
        .tag.mountain { background-color: var(--color-mountain); border-color: #cbd5e1; }
        .tag.desert { background-color: var(--color-desert); }
        .tag.swamp { background-color: var(--color-swamp); }
        .tag.ruins { background-color: var(--color-ruins); }
        .tag.cave { background-color: var(--color-cave); color: #475569; }

        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
        }

        .back-link:hover {
            color: var(--text-primary);
        }

        .terrain-icons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 10px;
        }

        .terrain-filter {
            background: #f1f5f9;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            white-space: nowrap;
            border: 1px solid #e2e8f0;
            transition: all 0.2s;
            color: #475569;
            font-weight: 500;
        }

        .terrain-filter.active {
            background: #1e293b;
            color: white;
            border-color: #1e293b;
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">‚Üê Retour √† l'accueil</a>
        
        <header>
            <h1>Pr√©f√©rences d'Exp√©dition des Familiers</h1>
        </header>

        <div class="card">
            <div class="controls">
                <input type="text" id="searchInput" placeholder="Rechercher par nom ou ID...">
                <select id="preferenceFilter">
                    <option value="all">Toutes les pr√©f√©rences</option>
                    <option value="liked">Aime seulement</option>
                    <option value="disliked">D√©teste seulement</option>
                </select>
                <select id="sortBy">
                    <option value="id">Trier par ID</option>
                    <option value="name">Trier par Nom</option>
                    <option value="likesCount">Trier par Nb. Aimes (D√©croissant)</option>
                    <option value="dislikesCount">Trier par Nb. D√©testes (D√©croissant)</option>
                </select>
            </div>
            
            <div id="terrainFilters" class="terrain-icons">
                <div class="terrain-filter active" data-terrain="all">Tous les terrains</div>
            </div>

            <div id="petGrid" class="pet-grid"></div>
        </div>
    </div>

    <script>
        const PET_NAMES = {
            1: "üê∂ Chien", 2: "üê© Caniche", 20: "ü¶ä Renard", 28: "üê∫ Loup",
            3: "üê± Chat", 4: "üêà‚Äç‚¨õ Chat Noir", 56: "üêØ Tigre", 57: "ü¶Å Lion", 60: "üêÜ L√©opard",
            5: "üê≠ Souris", 6: "üêπ Hamster", 7: "üê∞ Lapin", 35: "ü¶ù Raton Laveur", 40: "üêøÔ∏è Tamias", 41: "ü¶î H√©risson", 93: "üêÄ Rat",
            8: "üêÑ Vache", 9: "üêñ Cochon", 17: "üêë Mouton", 18: "üêê Ch√®vre", 96: "ü´è √Çne",
            10: "üêî Poule", 12: "ü¶Ü Canard", 19: "ü¶É Dindon", 92: "üê§ Poussin", 97: "ü™ø Oie",
            11: "üê¶ Oiseau", 26: "ü¶â Chouette", 27: "ü¶á Chauve-souris", 33: "ü¶¢ Cygne", 34: "ü¶© Flamant Rose", 53: "ü¶ö Paon", 54: "ü¶ú Perroquet", 58: "ü¶Ö Aigle", 62: "üïäÔ∏è Colombe", 94: "üê¶‚Äç‚¨õ Merle", 95: "üê¶‚Äç‚¨õ Corbeau", 59: "ü¶§ Dodo",
            13: "üêé Cheval", 47: "ü¶ì Z√®bre", 98: "ü´é √âlan",
            14: "üê¢ Tortue", 15: "üêç Serpent", 16: "ü¶é L√©zard", 44: "ü¶Ç Scorpion", 45: "üêä Crocodile",
            21: "üêª Ours", 42: "üêª‚Äç‚ùÑÔ∏è Ours Polaire", 43: "üêº Panda",
            23: "üê∏ Grenouille",
            24: "üêí Singe", 90: "ü¶ß Orang-outan", 91: "ü¶ç Gorille",
            25: "üêß Manchot", 72: "üêß Manchot Empereur", 30: "ü¶≠ Phoque",
            22: "üê® Koala", 52: "ü¶ò Kangourou",
            31: "ü¶õ Hippopotame", 46: "üêò √âl√©phant", 48: "ü¶è Rhinoc√©ros", 51: "ü¶í Girafe",
            29: "üêó Sanglier", 32: "ü¶ô Lama", 49: "üê™ Dromadaire", 50: "üê´ Chameau",
            36: "ü¶® Moufette", 37: "ü¶° Blaireau", 38: "ü¶´ Castor", 39: "ü¶• Paresseux", 55: "ü¶¶ Loutre", 87: "ü¶å Cerf", 88: "üêÉ Buffle d'eau", 89: "ü¶¨ Bison",
            71: "üêô Poulpe", 73: "üêü Poisson", 74: "üê† Poisson Tropical", 75: "üê° Poisson-globe", 76: "ü™º M√©duse", 77: "ü¶à Requin", 78: "üêã Baleine", 79: "üêã Baleine (2)", 80: "ü¶ê Crevette", 81: "ü¶û Homard", 82: "üê¨ Dauphin", 86: "ü¶Ä Crabe", 85: "üêå Escargot",
            61: "ü¶£ Mammouth", 63: "ü¶Ñ Licorne", 64: "üêâ Dragon", 65: "ü¶ñ T-Rex", 83: "üê¶‚Äçüî• Ph√©nix", 84: "ü¶ï Diplodocus",
            66: "üëΩ Stitch", 67: "‚õÑ Bonhomme de Neige", 68: "ü¶Ü Canard √âcarlate", 69: "‚òÉÔ∏è Personne de Neige", 70: "üëΩ Alien", 99: "üéÉ Citrouille", 100: "üëª Fant√¥me", 101: "üßõ Vampire"
        };

        const TERRAIN_NAMES = {
            plains: "üåø Plaines",
            forest: "üå≤ For√™t",
            coast: "üåä C√¥te",
            mountain: "üèîÔ∏è Montagne",
            desert: "üèúÔ∏è D√©sert",
            swamp: "üêä Marais",
            ruins: "üèõÔ∏è Ruines",
            cave: "üï≥Ô∏è Caverne"
        };

        const PREFERENCES = {
            0: { liked: [], disliked: [] },
            1: { liked: ["forest", "plains", "mountain"], disliked: ["swamp"] },
            2: { liked: ["plains", "ruins"], disliked: ["swamp", "cave"] },
            20: { liked: ["forest", "plains"], disliked: ["desert"] },
            28: { liked: ["forest", "mountain", "plains"], disliked: ["desert"] },
            3: { liked: ["ruins", "forest", "plains"], disliked: ["swamp"] },
            4: { liked: ["ruins", "cave", "forest"], disliked: ["desert"] },
            56: { liked: ["forest", "swamp"], disliked: ["desert", "coast"] },
            57: { liked: ["plains", "desert"], disliked: ["swamp", "forest"] },
            60: { liked: ["forest", "mountain"], disliked: ["coast"] },
            5: { liked: ["plains", "cave", "ruins"], disliked: [] },
            6: { liked: ["plains", "desert", "cave"], disliked: ["swamp"] },
            7: { liked: ["plains", "forest"], disliked: ["desert", "swamp"] },
            35: { liked: ["forest", "ruins"], disliked: ["desert"] },
            40: { liked: ["forest", "mountain"], disliked: ["desert", "coast"] },
            41: { liked: ["forest", "plains"], disliked: ["desert"] },
            93: { liked: ["ruins", "cave", "swamp"], disliked: [] },
            8: { liked: ["plains", "forest"], disliked: ["mountain", "desert"] },
            9: { liked: ["plains", "forest", "swamp"], disliked: ["desert"] },
            17: { liked: ["plains", "mountain"], disliked: ["swamp", "desert"] },
            18: { liked: ["mountain", "ruins", "plains"], disliked: ["swamp"] },
            96: { liked: ["plains", "mountain", "desert"], disliked: ["swamp"] },
            10: { liked: ["plains", "forest"], disliked: ["mountain", "cave"] },
            12: { liked: ["coast", "swamp", "plains"], disliked: ["desert", "cave"] },
            19: { liked: ["forest", "plains"], disliked: ["desert", "coast"] },
            92: { liked: ["plains", "forest"], disliked: ["mountain", "cave", "swamp"] },
            97: { liked: ["plains", "coast", "swamp"], disliked: ["desert", "cave"] },
            11: { liked: ["forest", "plains", "mountain"], disliked: ["cave"] },
            26: { liked: ["forest", "ruins", "cave"], disliked: ["desert"] },
            27: { liked: ["cave", "ruins", "forest"], disliked: ["desert", "plains"] },
            33: { liked: ["coast", "swamp", "plains"], disliked: ["desert", "cave"] },
            34: { liked: ["coast", "swamp"], disliked: ["cave", "mountain", "desert"] },
            53: { liked: ["forest", "ruins", "plains"], disliked: ["desert"] },
            54: { liked: ["forest", "coast", "ruins"], disliked: ["mountain", "desert"] },
            58: { liked: ["mountain", "plains"], disliked: ["cave", "swamp"] },
            62: { liked: ["plains", "forest", "ruins"], disliked: ["cave"] },
            94: { liked: ["forest", "plains", "ruins"], disliked: ["desert"] },
            95: { liked: ["ruins", "forest", "plains"], disliked: [] },
            59: { liked: ["forest", "coast", "plains"], disliked: ["mountain", "cave"] },
            13: { liked: ["plains", "mountain"], disliked: ["swamp", "cave"] },
            47: { liked: ["plains", "desert"], disliked: ["swamp", "cave", "forest"] },
            98: { liked: ["forest", "mountain"], disliked: ["desert", "coast"] },
            14: { liked: ["coast", "swamp", "plains"], disliked: ["desert", "mountain"] },
            15: { liked: ["desert", "swamp", "ruins"], disliked: ["mountain"] },
            16: { liked: ["desert", "ruins", "cave"], disliked: ["swamp"] },
            44: { liked: ["desert", "cave", "ruins"], disliked: ["coast", "swamp", "forest"] },
            45: { liked: ["swamp", "coast"], disliked: ["desert", "mountain"] },
            21: { liked: ["forest", "mountain", "cave"], disliked: ["desert"] },
            42: { liked: ["coast", "mountain"], disliked: ["desert", "swamp", "forest"] },
            43: { liked: ["forest", "mountain"], disliked: ["desert", "coast"] },
            23: { liked: ["swamp", "coast", "forest"], disliked: ["desert", "mountain"] },
            24: { liked: ["forest", "ruins"], disliked: ["desert", "coast"] },
            90: { liked: ["forest", "swamp"], disliked: ["desert", "mountain"] },
            91: { liked: ["forest", "mountain"], disliked: ["desert", "coast"] },
            25: { liked: ["coast", "mountain"], disliked: ["desert", "forest", "swamp"] },
            72: { liked: ["coast", "mountain"], disliked: ["desert", "forest", "swamp"] },
            30: { liked: ["coast", "cave"], disliked: ["desert", "forest"] },
            22: { liked: ["forest"], disliked: ["desert", "cave", "swamp"] },
            52: { liked: ["plains", "desert"], disliked: ["cave", "swamp"] },
            31: { liked: ["swamp", "coast"], disliked: ["desert", "mountain", "cave"] },
            46: { liked: ["plains", "forest"], disliked: ["cave", "mountain"] },
            48: { liked: ["plains", "swamp"], disliked: ["cave", "mountain"] },
            51: { liked: ["plains", "forest"], disliked: ["cave", "mountain", "swamp"] },
            29: { liked: ["forest", "swamp", "plains"], disliked: ["desert"] },
            32: { liked: ["mountain", "desert", "plains"], disliked: ["swamp"] },
            49: { liked: ["desert", "plains"], disliked: ["coast", "swamp", "forest"] },
            50: { liked: ["desert", "plains"], disliked: ["coast", "swamp", "forest"] },
            36: { liked: ["forest", "plains"], disliked: ["desert"] },
            37: { liked: ["forest", "plains", "cave"], disliked: ["desert"] },
            38: { liked: ["forest", "coast", "swamp"], disliked: ["desert", "mountain"] },
            39: { liked: ["forest", "swamp"], disliked: ["desert", "mountain"] },
            55: { liked: ["coast", "forest", "swamp"], disliked: ["desert"] },
            87: { liked: ["forest", "plains"], disliked: ["desert", "swamp"] },
            88: { liked: ["plains", "swamp", "forest"], disliked: ["desert"] },
            89: { liked: ["plains", "mountain"], disliked: ["swamp", "cave"] },
            71: { liked: ["coast", "cave"], disliked: ["desert", "mountain", "plains"] },
            73: { liked: ["coast", "swamp"], disliked: ["desert", "mountain", "plains"] },
            74: { liked: ["coast", "swamp"], disliked: ["desert", "mountain"] },
            75: { liked: ["coast", "swamp"], disliked: ["desert", "mountain"] },
            76: { liked: ["coast", "swamp"], disliked: ["desert", "mountain", "plains"] },
            77: { liked: ["coast"], disliked: ["desert", "mountain", "forest", "plains"] },
            78: { liked: ["coast"], disliked: ["desert", "mountain", "forest", "plains"] },
            79: { liked: ["coast"], disliked: ["desert", "mountain", "forest", "plains"] },
            80: { liked: ["coast", "swamp", "cave"], disliked: ["desert", "mountain"] },
            81: { liked: ["coast", "cave"], disliked: ["desert", "mountain", "plains"] },
            82: { liked: ["coast"], disliked: ["desert", "mountain", "cave"] },
            86: { liked: ["coast", "swamp", "cave"], disliked: ["desert"] },
            85: { liked: ["forest", "swamp", "ruins"], disliked: ["desert"] },
            61: { liked: ["mountain", "plains"], disliked: ["desert", "swamp", "coast"] },
            63: { liked: ["forest", "plains"], disliked: ["cave", "swamp"] },
            64: { liked: ["mountain", "cave", "ruins"], disliked: ["swamp"] },
            65: { liked: ["plains", "forest", "swamp"], disliked: ["coast", "cave"] },
            83: { liked: ["mountain", "desert", "ruins"], disliked: ["coast", "swamp"] },
            84: { liked: ["plains", "forest", "swamp"], disliked: ["cave", "mountain"] },
            66: { liked: ["ruins", "coast", "cave"], disliked: [] },
            67: { liked: ["mountain"], disliked: ["desert", "swamp"] },
            68: { liked: ["coast", "swamp", "plains"], disliked: ["desert"] },
            69: { liked: ["mountain"], disliked: ["desert", "swamp"] },
            70: { liked: ["ruins", "desert", "cave"], disliked: [] },
            99: { liked: ["ruins", "cave", "swamp"], disliked: ["coast", "desert"] },
            100: { liked: ["ruins", "cave"], disliked: ["plains"] },
            101: { liked: ["cave", "ruins", "forest"], disliked: ["plains", "desert"] }
        };

        let currentTerrain = 'all';

        function renderPets() {
            const grid = document.getElementById('petGrid');
            const search = document.getElementById('searchInput').value.toLowerCase();
            const prefFilter = document.getElementById('preferenceFilter').value;
            const sortVal = document.getElementById('sortBy').value;
            
            grid.innerHTML = '';

            let petList = Object.entries(PREFERENCES).map(([id, prefs]) => ({
                id,
                name: PET_NAMES[id] || `Familier ${id}`,
                prefs
            }));

            // Filtering
            petList = petList.filter(pet => {
                const name = pet.name.toLowerCase();
                if (search && !name.includes(search) && !pet.id.includes(search)) return false;
                
                if (currentTerrain !== 'all') {
                    if (prefFilter === 'liked' && !pet.prefs.liked.includes(currentTerrain)) return false;
                    if (prefFilter === 'disliked' && !pet.prefs.disliked.includes(currentTerrain)) return false;
                    if (prefFilter === 'all' && !pet.prefs.liked.includes(currentTerrain) && !pet.prefs.disliked.includes(currentTerrain)) return false;
                } else if (prefFilter !== 'all') {
                    if (prefFilter === 'liked' && pet.prefs.liked.length === 0) return false;
                    if (prefFilter === 'disliked' && pet.prefs.disliked.length === 0) return false;
                }
                return true;
            });

            // Sorting
            petList.sort((a, b) => {
                switch(sortVal) {
                    case 'name': return a.name.localeCompare(b.name);
                    case 'likesCount': return b.prefs.liked.length - a.prefs.liked.length;
                    case 'dislikesCount': return b.prefs.disliked.length - a.prefs.disliked.length;
                    default: return parseInt(a.id) - parseInt(b.id);
                }
            });

            petList.forEach(({id, name, prefs}) => {
                const card = document.createElement('div');
                card.className = 'pet-card';

                const likedTags = prefs.liked.map(t => `<span class="tag ${t}">${TERRAIN_NAMES[t]}</span>`).join('');
                const dislikedTags = prefs.disliked.map(t => `<span class="tag ${t}">${TERRAIN_NAMES[t]}</span>`).join('');

                card.innerHTML = `
                    <div class="pet-header">
                        <span class="pet-name">${name}</span>
                        <span class="pet-id">#${id}</span>
                    </div>
                    ${likedTags ? `
                        <div class="preference-section liked">
                            <div class="preference-title">Aime (${prefs.liked.length})</div>
                            <div class="tag-list">${likedTags}</div>
                        </div>
                    ` : ''}
                    ${dislikedTags ? `
                        <div class="preference-section disliked">
                            <div class="preference-title">D√©teste (${prefs.disliked.length})</div>
                            <div class="tag-list">${dislikedTags}</div>
                        </div>
                    ` : ''}
                    ${!likedTags && !dislikedTags ? '<div class="preference-section"><div class="preference-title">Neutre</div></div>' : ''}
                `;
                grid.appendChild(card);
            });
        }

        // Initialize terrain filters
        const terrainFilterContainer = document.getElementById('terrainFilters');
        for (const [key, name] of Object.entries(TERRAIN_NAMES)) {
            const el = document.createElement('div');
            el.className = 'terrain-filter';
            el.dataset.terrain = key;
            el.textContent = name;
            el.onclick = () => {
                document.querySelector('.terrain-filter.active').classList.remove('active');
                el.classList.add('active');
                currentTerrain = key;
                renderPets();
            };
            terrainFilterContainer.appendChild(el);
        }

        document.getElementById('searchInput').oninput = renderPets;
        document.getElementById('preferenceFilter').onchange = renderPets;
        document.getElementById('sortBy').onchange = renderPets;

        // Reset all filter
        document.querySelector('[data-terrain="all"]').onclick = (e) => {
            document.querySelector('.terrain-filter.active').classList.remove('active');
            e.target.classList.add('active');
            currentTerrain = 'all';
            renderPets();
        };

        window.onload = renderPets;
    </script>
</body>
</html>
